<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RILMA: Evoluci√≥n Total</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: none; }
        
        /* El fondo cambia suavemente gracias a esta transici√≥n */
        body { 
            background: #87CEEB; 
            overflow: hidden; 
            height: 100vh; 
            font-family: 'Arial Black', sans-serif; 
            transition: background 3s ease; 
        }
        
        #marcador {
            position: absolute; top: 10px; width: 100%; text-align: center;
            font-weight: bold; font-size: 18px; z-index: 10; color: #fff;
            text-shadow: 2px 2px #000; pointer-events: none;
        }

        #best-score { color: #FFD700; font-size: 16px; display: block; margin-top: 5px; }

        #rilma {
            position: absolute; bottom: 60px; left: 50%;
            font-size: 75px; transform: translateX(-50%); z-index: 5;
        }

        .objeto { position: absolute; font-size: 45px; z-index: 4; filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.2)); }
        
        #suelo { 
            position: absolute; bottom: 0; width: 100%; height: 50px; 
            background: #4CAF50; border-top: 5px solid #2E7D32; 
        }

        /* Nubes para que el cielo no sea plano */
        .nube {
            position: absolute; background: white; border-radius: 50px;
            opacity: 0.6; z-index: 1; animation: moverNubes 25s linear infinite;
        }

        @keyframes moverNubes {
            from { left: -150px; }
            to { left: 100%; }
        }
    </style>
</head>
<body>

    <div id="marcador">
        RILMA - COSECHA PROFESIONAL<br>
        PUNTOS: <span id="puntos">0</span> | VIDAS: <span id="vidas">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
        <span id="best-score">üèÜ R√âCORD: <span id="record-num">0</span></span>
    </div>

    <div class="nube" style="top:15%; width:120px; height:40px;"></div>
    <div class="nube" style="top:5%; width:80px; height:30px; animation-delay: 10s;"></div>

    <div id="rilma">üë©‚Äçüåæ</div>
    <div id="suelo"></div>

    <script>
        var score = 0;
        var lives = 3;
        var speed = 7; 
        var rilma = document.getElementById('rilma');
        var ptsTxt = document.getElementById('puntos');
        var vdsTxt = document.getElementById('vidas');
        var recordTxt = document.getElementById('record-num');
        
        var frutas = ["üçé", "üçå", "üçì", "üçä", "üçá", "üçç", "ü•≠", "üçí", "ü•ù", "üçâ", "üçë"];

        // Cargar R√©cord
        var highScore = localStorage.getItem("rilmaHighScore") || 0;
        recordTxt.innerText = highScore;

        function mover(e) {
            var x = e.touches ? e.touches[0].clientX : e.clientX;
            if (x > 40 && x < window.innerWidth - 40) {
                rilma.style.left = x + 'px';
            }
        }

        document.addEventListener('touchmove', function(e) { e.preventDefault(); mover(e); }, { passive: false });
        document.addEventListener('mousemove', mover);

        // FUNCI√ìN DE CLIMA (ACTUALIZADA)
        function actualizarClima() {
            if (score >= 30) {
                document.body.style.background = "#0d1b2a"; // Noche profunda
            } else if (score >= 15) {
                document.body.style.background = "#e67e22"; // Atardecer naranja
            } else {
                document.body.style.background = "#87CEEB"; // D√≠a azul
            }
        }

        function crear() {
            if (lives <= 0) return;
            var obj = document.createElement('div');
            obj.className = 'objeto';
            var esBomba = Math.random() < 0.25; 
            obj.innerHTML = esBomba ? "üí£" : frutas[Math.floor(Math.random() * frutas.length)];
            obj.style.left = Math.random() * (window.innerWidth - 60) + 30 + "px";
            obj.style.top = "-60px";
            document.body.appendChild(obj);

            var y = -60;
            var caer = setInterval(function() {
                y += speed;
                obj.style.top = y + "px";
                var rRect = rilma.getBoundingClientRect();
                var oRect = obj.getBoundingClientRect();

                if (oRect.bottom > rRect.top + 20 && oRect.left < rRect.right && oRect.right > rRect.left && oRect.top < rRect.bottom) {
                    if (esBomba) {
                        lives--;
                        document.body.style.filter = "invert(20%)"; // Efecto visual de da√±o
                        setTimeout(function(){ document.body.style.filter = "none"; }, 150);
                    } else {
                        score++;
                        ptsTxt.innerText = score;
                        actualizarClima(); // Cambia el clima seg√∫n puntos
                        if (score % 5 === 0) speed += 0.8;
                        
                        // SECRETO: Rilma se convierte en superhero√≠na a los 50 puntos
                        if (score === 50) {
                            rilma.innerHTML = "ü¶∏‚Äç‚ôÄÔ∏è";
                            alert("¬°RILMA EVOLUCION√ì!");
                        }
                    }
                    actualizarVidas();
                    obj.remove();
                    clearInterval(caer);
                }

                if (y > window.innerHeight) {
                    if (!esBomba) { lives--; actualizarVidas(); }
                    obj.remove();
                    clearInterval(caer);
                }
            }, 20);
        }

        function actualizarVidas() {
            var corazones = "";
            for(var i=0; i<lives; i++) corazones += "‚ù§Ô∏è";
            vdsTxt.innerText = corazones || "üíÄ";
            
            if (lives <= 0) {
                if (score > highScore) {
                    localStorage.setItem("rilmaHighScore", score);
                    alert("üèÜ ¬°NUEVO R√âCORD!\nCosechaste " + score + " frutas.");
                } else {
                    alert("¬°FIN DEL JUEGO!\nPuntos: " + score);
                }
                location.reload();
            }
        }

        setInterval(crear, 1000);
    </script>
</body>
</html>
